<!DOCTYPE html>
<html>
<head>
	<title>InCrowd</title>
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="public/reset.css">
	
	<!-- Bootstrap References -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.1.5/css/uikit.min.css" />

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

     <link type="text/css" rel="stylesheet" href="public/materialize.min.css"  media="screen,projection"/>
     <link type ="text/css" rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
       <script src="https://kit.fontawesome.com/5ff8955d5b.js"></script>

      <!--Let browser know website is optimized for mobile-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
         

    <link rel="stylesheet" href=" public/survey.css">



</head>
<body>
<div class = "container" id = "left">
  <h1>InCrowd</h1>
  <div class="row">
    <form class="col s12">
      <div class="row">
        <div class="input-field col s3">
          <input id="name" type="text" class="validate">
          <label for="name">Your Name</label>
        </div>       
      </div>
      <div class = "row">
       <div class="input-field col s3">
          <input id="songLink" type="text" class="validate">
          <label for="songLink">Favorite song link</label>
        </div>
      </div>
      <div class = "row" id = "submitSection">
         <p uk-margin>
          <a class="uk-button uk-button-default" id = "submit" href="#modal-media-youtube" uk-toggle>Submit</a>
        </p>
    </div>
    </form>
  </div>
  <footer class="footer">
      <div class="container-fluid">
        <p><a href="/api/survey">API Survey Link</a>    <a href="https://github.com/chloezhouny/InCrowd">Github Repo</a>
      </div>
</footer>

    
</div>





<div class = "container" id = "albums">
<div uk-slider="center: true">

    <div class="uk-position-relative uk-visible-toggle uk-light" tabindex="-1">

        <ul class="uk-slider-items uk-child-width-1-1@s uk-grid">
            <li>
                <div class="uk-card uk-card-default">
                    <div class="uk-card-media-top">
                        <img src="public/images/classical.jpg" alt="">
                    </div>
                    <div class="uk-card-body question">
                        <h3 class="uk-card-title">Classical</h3>                       
                        <form action="#">
                          <p class="range-field">
                            <input type="range" class= "test" id="test0" data-number = "0" min="1" max="5" />
                          </p>
                        </form>
                    </div>
                </div>
            </li>
            <li>
                <div class="uk-card uk-card-default">
                    <div class="uk-card-media-top">
                        <img src="public/images/classical.jpg" alt="">
                    </div>
                    <div class="uk-card-body question">
                        <h3 class="uk-card-title">Blues</h3>
                        <form action="#">
                          <p class="range-field">
                            <input type="range" class= "test" id="test1" data-number = "1" min="1" max="5" />
                          </p>
                        </form>
                    </div>
                </div>
            </li>
            <li>
                <div class="uk-card uk-card-default">
                    <div class="uk-card-media-top">
                        <img src="public/images/classical.jpg" alt="">
                    </div>
                    <div class="uk-card-body question">
                        <h3 class="uk-card-title">Jazz</h3>
                        <form action="#">
                          <p class="range-field">
                            <input type="range" class= "test" id="test2" data-number = "2" min="1" max="5" />
                          </p>
                        </form>
                    </div>
                </div>
            </li>
            <li>
                <div class="uk-card uk-card-default">
                    <div class="uk-card-media-top">
                        <img src="public/images/classical.jpg" alt="">
                    </div>
                    <div class="uk-card-body question">
                        <h3 class="uk-card-title">EDM</h3>
                        <form action="#">
                          <p class="range-field">
                            <input type="range" class= "test" id="test3" data-number = "3" min="1" max="5" />
                          </p>
                        </form>
                    </div>
                </div>
            </li>
            <li>
                <div class="uk-card uk-card-default">
                    <div class="uk-card-media-top">
                        <img src="public/images/classical.jpg" alt="">
                    </div>
                    <div class="uk-card-body question">
                        <h3 class="uk-card-title">Rock</h3>
                        <form action="#">
                          <p class="range-field">
                            <input type="range" class= "test" id="test4" data-number = "4" min="1" max="5" />
                          </p>
                        </form>
                    </div>
                </div>
            </li>
            <li>
                <div class="uk-card uk-card-default">
                    <div class="uk-card-media-top">
                        <img src="public/images/classical.jpg" alt="">
                    </div>
                    <div class="uk-card-body question">
                        <h3 class="uk-card-title">R&B</h3>
                        <form action="#">
                          <p class="range-field">
                            <input type="range" class= "test" id="test5" data-number = "5" min="1" max="5" />
                          </p>
                        </form>
                    </div>
                </div>
            </li>
            <li>
                <div class="uk-card uk-card-default">
                    <div class="uk-card-media-top">
                        <img src="public/images/classical.jpg" alt="">
                    </div>
                    <div class="uk-card-body question">
                        <h3 class="uk-card-title">Funk</h3>
                        <form action="#">
                          <p class="range-field">
                            <input type="range" class= "test" id="test6" data-number = "6" min="1" max="5" />
                          </p>
                        </form>
                    </div>
                </div>
            </li>
            <li>
                <div class="uk-card uk-card-default">
                    <div class="uk-card-media-top">
                        <img src="public/images/classical.jpg" alt="">
                    </div>
                    <div class="uk-card-body question">
                        <h3 class="uk-card-title">Hip-pop</h3>
                        <form action="#">
                          <p class="range-field">
                            <input type="range" class= "test" id="test7" data-number = "7" min="1" max="5" />
                          </p>
                        </form>
                    </div>
                </div>
            </li>
            <li>
                <div class="uk-card uk-card-default">
                    <div class="uk-card-media-top">
                        <img src="public/images/classical.jpg" alt="">
                    </div>
                    <div class="uk-card-body question">
                        <h3 class="uk-card-title">Country</h3>
                        <form action="#">
                          <p class="range-field">
                            <input type="range" class= "test" id="test8" data-number = "8" min="1" max="5" />
                          </p>
                        </form>
                    </div>
                </div>
            </li>

             <li>
                <div class="uk-card uk-card-default">
                    <div class="uk-card-media-top">
                        <img src="public/images/classical.jpg" alt="">
                    </div>
                    <div class="uk-card-body question">
                        <h3 class="uk-card-title">Indie</h3>
                        <form action="#">
                          <p class="range-field">
                            <input type="range" class= "test" id="test9" data-number = "9" min="1" max="5" />
                          </p>
                        </form>
                    </div>
                </div>
            </li>
        </ul>

        <div id = "sliders" >

        <a  href="#"  uk-slider-item="previous" id = "sliderleft"><img src= "public/images/arrow-left.png"></a>
        <a href="#"  uk-slider-item="next" id = "sliderright"><img src="public/images/arrow-right.png"></a>
       </div>
 

    </div>

    <ul class="uk-slider-nav uk-dotnav uk-flex-center uk-margin"></ul>

</div>
</div>




<div id="modal-media-youtube" class="uk-flex-top" uk-modal>
    <div class="uk-modal-dialog uk-width-auto uk-margin-auto-vertical">
      <div class="uk-modal-header">
      <h2 class="uk-modal-title" id = "matchedName"></h2>
    </div>
        <button class="uk-modal-close-outside" type="button" uk-close></button>
        <iframe id = "youtubeIframe" width="1920" height="1080" frameborder="0" uk-video></iframe>
    </div>
</div>





 <!-- Javascript  -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.1.5/js/uikit.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.1.5/js/uikit-icons.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript" src="public/materialize.min.js"></script>

<script>
var userAnswer = [];
var idNameArr = ['test0', 'test1', 'test2', 'test3','test4','test5','test6','test7', 'test8','test9'];

for (var i = 0; i < idNameArr.length; i++)
{
  document.getElementById(idNameArr[i]).oninput = function()
  {
    var index = this.getAttribute("data-number");
    console.log(this.value);
    userAnswer[index] = parseInt(this.value);
    console.log(userAnswer);
  }
}



$("#submit").on("click", function(event) {
  if ((!userAnswer.includes(undefined)) && ($("#name").val().trim() !== undefined) && ($("#songLink").val().trim() !== undefined))
  {
      var userInfo = 
      {
            name: $("#name").val().trim(),
            songLink: $("#songLink").val().trim(),
            scores: userAnswer
      }
      console.log(userInfo);

    $.post("/api/survey", userInfo,
        function(data) {

          // If a table is available... tell user they are booked.
          if (data) {
            alert("Adding");
          }

          // Clear the form when submitting
          for (var i = 0; i < idNameArr.length; i++)
          {
            var name = "#" + idNameArr[i];
            $(name).val("");
          }
          
        }).then(function(data) {
          console.log("WE GOT THIS FROM THE BACKEND", data.matchedUser);
          var name = data.matchedUser.name;
          var link = data.matchedUser.songLink;
          var linkId = link.split("=");
          console.log(linkId[1]);
          
          var youtubeLink = "https://www.youtube-nocookie.com/embed/" + linkId[1];
          document.getElementById("youtubeIframe").setAttribute("src", youtubeLink);
          document.getElementById("matchedName").innerHTML = name;

          console.log(document.getElementById("youtubeIframe").getAttribute("src"));
          });
    }
});


 

</script>

</body>
</html>