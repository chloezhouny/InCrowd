<!DOCTYPE html>
<html>
<head>
	<title>InCrowd</title>
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="public/reset.css">
	
	<!-- Bootstrap References -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.1.5/css/uikit.min.css" />

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

 <!--     <link type="text/css" rel="stylesheet" href="public/materialize.min.css"  media="screen,projection"/> -->
     <link type ="text/css" rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
       <script src="https://kit.fontawesome.com/5ff8955d5b.js"></script>
       <link href="https://fonts.googleapis.com/css?family=Archivo+Black|Exo+2:800|Open+Sans:300|Work+Sans:700&display=swap" rel="stylesheet">


      <!--Let browser know website is optimized for mobile-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
         

    <link rel="stylesheet" href=" public/survey.css">



</head>
<body class = "uk-background-fixed uk-background-center-center">
<div id = "bodyContainer">
    <header class = "container-fluid pt-5">
      <div class = "row">
          <div id="brand">
            <h1>InCrowd</h1>
          </div>

          <div class="col-12 d-flex flex-row justify-content-center" id = "header">
              <a id = "home" href="/">HOME</a> 
              <a href="/api/survey">API Survey Link</a>    
              <a href="https://github.com/chloezhouny/InCrowd">Github Repo</a>
              <div>

          </div>
        </div>
    </header>


  <div class = "container" id = "left">
    <div class = "container d-flex justify-content-center">
            <form>
                <div class="uk-margin text-center">
                    <div class="uk-inline">
                        <a class="uk-form-icon" href="#" uk-icon="icon: user"></a>
                        <input class="uk-input uk-form-width-large" type="text" placeholder="Your Name" id="name">                       
                    </div>
                    <div id="nameValidate"></div>
                </div>

                <div class="uk-margin text-center">
                    <div class="uk-inline">
                        <a class="uk-form-icon uk-form-icon-flip" href="#" uk-icon="icon: link"></a>
                        <input class="uk-input uk-form-width-large" type="text" placeholder = "Youtube Link of Your Favorite Song" id="songLink">
                       
                    </div>
                     <div id="songValidate"></div>
                </div>

                <div class = "text-center" id = "submitNameSection">
                   <p uk-margin>
                    <a class="uk-button uk-button-default uk-width-1-2" id = "submitName">Submit</a>
                    </p>
                </div>

          </form>
    </div>
  </div>





<div class = "container" id = "albums">
<div uk-slider="center: true">

    <div class="uk-position-relative uk-visible-toggle uk-light" tabindex="-1" uk-slider="clsActivated: uk-transition-active; center: true">


        <ul class="uk-slider-items uk-child-width-1-2@s uk-grid">
            <li >
                <div class="uk-card uk-card-default">
                    <div class= "uk-card-media-top uk-panel uk-transition-toggle" tabindex="0">
                        <img src="public/images/blues.jpg" width="100%" alt="">
                        
                        <div class="uk-position-bottom uk-text-center uk-transition-slide-bottom p-0">  
                            
                            <iframe src="https://open.spotify.com/embed/playlist/37i9dQZF1DXcnkReojaCnV" width="100%" height="80" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
                        </div>
              
                    </div>
                  
                    <div class="uk-card-body question d-flex flex-row justify-content-center mt-4 pb-0 starsSection" >  

                        <form class = "stars">
                            <fieldset class="rating">
                                <input type="radio" id="star05" name="rating" value="5" data-number = "0"/><label for="star05"  title="Rocks!">5 stars</label>
                                <input type="radio" id="star04" name="rating" value="4" data-number = "0"/><label for="star04" title="Pretty good">4 stars</label>
                                <input type="radio" id="star03" name="rating" value="3" data-number = "0"/><label for="star03" title="Meh">3 stars</label>
                                <input type="radio"  id="star02" name="rating" value="2" data-number = "0"/><label for="star02" title="Kinda bad">2 stars</label>
                                <input type="radio"  id="star01" name="rating" value="1" data-number = "0"/><label for="star01" title="Sucks big time">1 star</label>
                            </fieldset>
                            <div class="clearfix"></div>
                        </form>

                    </div>
                </div>
            </li>
            <li>
                <div class="uk-card uk-card-default">
                    <div class="uk-card-media-top uk-panel uk-transition-toggle" tabindex="0">
                        <img src="public/images/classical.jpg"  width="100%" alt="">
                           <div class="uk-position-bottom uk-text-center uk-transition-slide-bottom p-0">  
                            <iframe src="https://open.spotify.com/embed/playlist/37i9dQZF1DWWEJlAGA9gs0" width="100%" height="80" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
                           </div>
                    </div>
                    <div class="uk-card-body question d-flex flex-row justify-content-center mt-4 pb-0 starsSection">

                        <form class = "stars">
                            <fieldset class="rating">
                                <input type="radio" id="star15" name="rating" value="5"  data-number = "1" /><label for="star15"title="Rocks!">5 stars</label>
                                <input type="radio" id="star14" name="rating" value="4"  data-number = "1" /><label for="star14" title="Pretty good">4 stars</label>
                                <input type="radio" id="star13" name="rating" value="3"  data-number = "1" /><label for="star13" title="Meh">3 stars</label>
                                <input type="radio"  id="star12" name="rating" value="2"  data-number = "1" /><label for="star12" title="Kinda bad">2 stars</label>
                                <input type="radio"  id="star11" name="rating" value="1"  data-number = "1" /><label for="star11" title="Sucks big time">1 star</label>
                            </fieldset>
                            <div class="clearfix"></div>              
                        </form>
                    </div>
                    </div>
           
            </li>
            <li>
                <div class="uk-card uk-card-default">
                    <div class="uk-card-media-top uk-panel uk-transition-toggle" tabindex="0">
                        <img src="public/images/country.jpg"  width="100%" alt="">
                        <div class="uk-position-bottom uk-text-center uk-transition-slide-bottom p-0 ">  
                            <iframe src="https://open.spotify.com/embed/playlist/37i9dQZF1DX1lVhptIYRda" width="100%" height="80" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
                        </div>  
                    </div>               
                    <div class="uk-card-body question d-flex flex-row justify-content-center mt-4 pb-0 starsSection">
                        <form class = "stars">
                            <fieldset class="rating">
                                <input type="radio" id="star52" name="rating" value="5" data-number = "2"/><label for="star52" title="Rocks!">5 stars</label>
                                <input type="radio" id="star42" name="rating" value="4" data-number = "2"/><label for="star42" title="Pretty good">4 stars</label>
                                <input type="radio" id="star32" name="rating" value="3" data-number = "2"/><label for="star32" title="Meh">3 stars</label>
                                <input type="radio"  id="star22" name="rating" value="2" data-number = "2"/><label for="star22" title="Kinda bad">2 stars</label>
                                <input type="radio"  id="star12" name="rating" value="1" data-number = "2"/><label for="star12" title="Sucks big time">1 star</label>
                            </fieldset>      
                        </form>
                    </div>            
                </div>
            </li>
            <li>
                <div class="uk-card uk-card-default">
                    <div class="uk-card-media-top uk-panel uk-transition-toggle" tabindex="0">
                        <img src="public/images/edm.jpg"  width="100%" alt="">
                        <div class="uk-position-bottom uk-text-center uk-transition-slide-bottom p-0">  
                            <iframe src="https://open.spotify.com/embed/playlist/37i9dQZF1DX4dyzvuaRJ0n" width="100%" height="80" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
                        </div> 
                    </div>                                  
                    <div class="uk-card-body question d-flex flex-row justify-content-center mt-4 pb-0 starsSection">
                        <form class = "stars">
                            <fieldset class="rating">
                                <input type="radio" id="star53" name="rating" value="5" data-number = "3"/><label for="star53" title="Rocks!">5 stars</label>
                                <input type="radio" id="star43" name="rating" value="4" data-number = "3"/><label for="star43" title="Pretty good">4 stars</label>
                                <input type="radio" id="star33" name="rating" value="3" data-number = "3"/><label for="star33" title="Meh">3 stars</label>
                                <input type="radio"  id="star23" name="rating" value="2" data-number = "3"/><label for="star23" title="Kinda bad">2 stars</label>
                                <input type="radio"  id="star13" name="rating" value="1" data-number = "3"/><label for="star13" title="Sucks big time">1 star</label>
                            </fieldset>
                        </form>
                    </div>
           
                </div>
            </li>
            <li>
                <div class="uk-card uk-card-default">
                    <div class="uk-card-media-top uk-panel uk-transition-toggle" tabindex="0">
                        <img src="public/images/jazz.jpg"  width="100%" alt="">
                        <div class="uk-position-bottom uk-text-center uk-transition-slide-bottom p-0">  
                            <iframe src="https://open.spotify.com/embed/playlist/37i9dQZF1DXbITWG1ZJKYt" width="100%" height="80" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
                        </div>  
                    </div>               
                    <div class="uk-card-body question d-flex flex-row justify-content-center mt-4 pb-0 starsSection">
                        <form class = "stars">
                            <fieldset class="rating">
  
                                <input type="radio" id="star54" name="rating" value="5" data-number = "4"/><label for="star54" title="Rocks!">5 stars</label>
                                <input type="radio" id="star44" name="rating" value="4" data-number = "4"/><label for="star44" title="Pretty good">4 stars</label>
                                <input type="radio" id="star34" name="rating" value="3" data-number = "4"/><label for="star34" title="Meh">3 stars</label>
                                <input type="radio"  id="star24" name="rating" value="2" data-number = "4"/><label for="star24" title="Kinda bad">2 stars</label>
                                <input type="radio"  id="star14" name="rating" value="1" data-number = "4"/><label for="star14" title="Sucks big time">1 star</label>
                            </fieldset>
                   
                        </form>
                    </div>
                    </div>
     
            </li>
            <li>
                <div class="uk-card uk-card-default">

                    <div class="uk-card-media-top uk-panel uk-transition-toggle" tabindex="0">
                        <img src="public/images/rap.jpg"  width="100%" alt="">
                        <div class="uk-position-bottom uk-text-center uk-transition-slide-bottom p-0">  
                            <iframe src="https://open.spotify.com/embed/playlist/37i9dQZF1DX0XUsuxWHRQd" width="100%" height="80" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
                        </div>  
                    </div>               
                    <div class="uk-card-body question d-flex flex-row justify-content-center mt-4 pb-0 starsSection">
                        <form class = "stars">
                            <fieldset class="rating">
                                <input type="radio" id="star55" name="rating" value="5" data-number = "5"/><label for="star55" title="Rocks!">5 stars</label>
                                <input type="radio" id="star45" name="rating" value="4" data-number = "5"/><label for="star45" title="Pretty good">4 stars</label>
                                <input type="radio" id="star35" name="rating" value="3" data-number = "5"/><label for="star35" title="Meh">3 stars</label>
                                <input type="radio"  id="star25" name="rating" value="2" data-number = "5"/><label for="star25" title="Kinda bad">2 stars</label>
                                <input type="radio"  id="star15" name="rating" value="1" data-number = "5"/><label for="star15" title="Sucks big time">1 star</label>
                            </fieldset>

       
                        </form>
                      </p>
                    </div>

                    </div>
  
            </li>
            <li>
                <div class="uk-card uk-card-default">
                    <div class="uk-card-media-top uk-panel uk-transition-toggle" tabindex="0">
                        <img src="public/images/pop.jpg"  width="100%" alt="">
                        <div class="uk-position-bottom uk-text-center uk-transition-slide-bottom p-0">  
                            <iframe src="https://open.spotify.com/embed/playlist/37i9dQZF1DXbYM3nMM0oPk" width="100%" height="80" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
                        </div>  
                    </div>               
                    <div class="uk-card-body question d-flex flex-row justify-content-center mt-4 pb-0 starsSection">
                        <form class = "stars">
                            <fieldset class="rating">
                                <input type="radio" id="star56" name="rating" value="5" data-number = "6"/><label for="star56" title="Rocks!">5 stars</label>
                                <input type="radio" id="star46" name="rating" value="4" data-number = "6"/><label for="star46" title="Pretty good">4 stars</label>
                                <input type="radio" id="star36" name="rating" value="3" data-number = "6"/><label for="star36" title="Meh">3 stars</label>
                                <input type="radio"  id="star26" name="rating" value="2" data-number = "6"/><label for="star26" title="Kinda bad">2 stars</label>
                                <input type="radio"  id="star16" name="rating" value="1" data-number = "6"/><label for="star16" title="Sucks big time">1 star</label>
                            </fieldset>
       
                        </form>
                    </div>

                    </div>
        
            </li>
            <li>
                <div class="uk-card uk-card-default">
                   <div class="uk-card-media-top uk-panel uk-transition-toggle" tabindex="0">
                        <img src="public/images/r&b.jpg"  width="100%" alt="">
                        <div class="uk-position-bottom uk-text-center uk-transition-slide-bottom p-0">  
                            <iframe src="https://open.spotify.com/embed/playlist/37i9dQZF1DX4SBhb3fqCJd" width="100%" height="80" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
                        </div>  
                    </div>               
                    <div class="uk-card-body question d-flex flex-row justify-content-center mt-4 pb-0 starsSection">
                        <form class = "stars">
                            <fieldset class="rating">
                                <input type="radio" id="star57" name="rating" value="5" data-number = "7"/><label for="star57" title="Rocks!">5 stars</label>
                                <input type="radio" id="star47" name="rating" value="4" data-number = "7"/><label for="star47" title="Pretty good">4 stars</label>
                                <input type="radio" id="star37" name="rating" value="3" data-number = "7"/><label for="star37" title="Meh">3 stars</label>
                                <input type="radio"  id="star27" name="rating" value="2" data-number = "7"/><label for="star27" title="Kinda bad">2 stars</label>
                                <input type="radio"  id="star17" name="rating" value="1" data-number = "7"/><label for="star17" title="Sucks big time">1 star</label>
                            </fieldset>
  
                        </form>
                    </div>

        
                </div>
            </li>
            <li>
                <div class="uk-card uk-card-default">
                    <div class="uk-card-media-top uk-panel uk-transition-toggle" tabindex="0">
                        <img src="public/images/rock.jpg"  width="100%" alt="">
                        <div class="uk-position-bottom uk-text-center uk-transition-slide-bottom p-0">  
                            <iframe src="https://open.spotify.com/embed/playlist/37i9dQZF1DWXRqgorJj26U" width="100%" height="80" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
                        </div>  
                    </div>               
                    <div class="uk-card-body question d-flex flex-row justify-content-center mt-4 pb-0 starsSection">
                          <form class = "stars">
                            <fieldset class="rating">
                                <input type="radio" id="star58" name="rating" value="5" data-number = "8"/><label for="star58" title="Rocks!">5 stars</label>
                                <input type="radio" id="star48" name="rating" value="4" data-number = "8"/><label for="star48" title="Pretty good">4 stars</label>
                                <input type="radio" id="star38" name="rating" value="3" data-number = "8"/><label for="star38" title="Meh">3 stars</label>
                                <input type="radio"  id="star28" name="rating" value="2" data-number = "8"/><label for="star28" title="Kinda bad">2 stars</label>
                                <input type="radio"  id="star18" name="rating" value="1" data-number = "8"/><label for="star18" title="Sucks big time">1 star</label>
                            </fieldset>
       
                        </form>
                    </div>

      
                </div>
            </li>

             <li>
                <div class="uk-card uk-card-default">
                    <div class="uk-card-media-top uk-panel uk-transition-toggle" tabindex="0">
                        <img src="public/images/Indie.jpg"  width="100%" alt="">
                        <div class="uk-position-bottom uk-text-center uk-transition-slide-bottom p-0">  
                            <iframe src="https://open.spotify.com/embed/playlist/37i9dQZF1DX2Nc3B70tvx0" width="100%" height="80" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
                        </div> 
                    </div>               
                    <div class="uk-card-body question d-flex flex-row justify-content-center pb-0 mt-4 starsSection">
                        <form class = "stars">
                            <fieldset class="rating">
                                <input type="radio" id="star59" name="rating" value="5" data-number = "9"/><label for="star59" title="Rocks!">5 stars</label>
                                <input type="radio" id="star49" name="rating" value="4" data-number = "9"/><label for="star49" title="Pretty good">4 stars</label>
                                <input type="radio" id="star39" name="rating" value="3" data-number = "9"/><label for="star39" title="Meh">3 stars</label>
                                <input type="radio"  id="star29" name="rating" value="2" data-number = "9"/><label for="star29" title="Kinda bad">2 stars</label>
                                <input type="radio"  id="star19" name="rating" value="1" data-number = "9"/><label for="star19" title="Sucks big time">1 star</label>
                            </fieldset>
                        </form>
                    </div>
                </div>
            </li>
        </ul>
      


          <div id = "sliders" >

              <a href="#"  uk-slider-item="previous" id = "sliderleft"><img src= "public/images/arrow-left.png"></a>
              <!-- class="uk-slidenav-large" uk-slidenav-previous -->

              
              <a href="#" uk-slider-item="next" id = "sliderright"><img src="public/images/arrow-right.png"></a>
            <!--   class="uk-slidenav-large" uk-slidenav-next  -->

             <!--  <a class="uk-position-center-left uk-position-small uk-hidden-hover" href="#" uk-slidenav-previous uk-slider-item="previous"></a>
          <a class="uk-position-center-right uk-position-small uk-hidden-hover" href="#" uk-slidenav-next uk-slider-item="next"></a> -->
              
          </div>
          
        </div>

        <ul class="uk-slider-nav uk-dotnav uk-flex-center uk-margin" id="dots"></ul>

    
    <div class = "row d-flex justify-content-center" id = "submitSection" >

           <a href="#modal-media-youtube" id="submitLink" uk-toggle><button class = "btn btn-lg btn-dark" id= "submit">Find Friend</button></a>
    </div>

</div>
</div>


</div>

  <div id="modal-media-youtube" class="uk-flex-top" uk-modal>
      <div class="uk-modal-dialog uk-width-auto uk-margin-auto-vertical">
        <div class="uk-modal-header" id = "nameSection">
            <h2 class="uk-modal-title" id = "matchedName"></h2>
        </div>
        <div>
          <button class="uk-modal-close-outside" type="button" uk-close></button>
          <iframe id = "youtubeIframe" width="740" height="409.5" frameborder="0" uk-video></iframe>
        </div>
      </div>
  </div>



 <!-- Javascript  -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.1.5/js/uikit.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.1.5/js/uikit-icons.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!-- <script type="text/javascript" src="public/materialize.min.js"></script> -->

<script>

// $("#left").show();
// $("#albums").hide();
// $("#submit").hide();

var nameTrue = false;
var songLinkTrue = false;

var userAnswer = [undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined];

// var idNameArr = ['.test1 :radio', 'test1', 'test2', 'test3','test4','test5','test6','test7', 'test8','test9'];
// var idNameArr = ['.test0 :radio', '.test1 :radio', '.test2 :radio', '.test3 :radio','.test4 :radio','.test5 :radio', '.test6 :radio','.test7 :radio', '.test8 :radio','.test9 :radio'];

function validateForm() {
  var x = $("#name").val().trim();
  if (x == "") {
    $("#nameValidate").text("*Required");
  }
  else
  {
    nameTrue = true;
  }
}

function ytVidId() {
    var url = $("#songLink").val().trim();
    var p = /^(?:https?:\/\/)?(?:www\.)?youtube\.com\/watch\?(?=.*v=((\w|-){11}))(?:\S+)?$/;
    var songValidate = (url.match(p)) ? RegExp.$1 : false;
    console.log(songValidate);
    if (songValidate === false)
    {
      $("#songValidate").text("*Link not valid");

    }
    else
    {
      document.getElementById("submitName").setAttribute("href", "#sliders");
      songLinkTrue = true;
    }

}






document.getElementById('submitName').onclick = function()  {

  validateForm();  
  ytVidId();
  console.log("name after submit" + $("#name").val().trim());

  // $("#left").hide();
  // $("#albums").show();
  
  };
   



$(document).on("click", ".stars :radio", function(event)
{   
    if ((nameTrue) && (songLinkTrue))
    {
    var selector = ".stars :radio" + "[name=rating]:checked";
     var value = $(selector).val();
     var index = this.getAttribute("data-number");
     console.log(index);
    console.log(value);
    userAnswer[index] = parseInt(value); 
    console.log(userAnswer); 

        if (!userAnswer.includes(undefined))
        {
          $("#submit").show();
        } 
    }
});




$(document).on("click", "#submit", function(event) {
  if ((!userAnswer.includes(undefined)) && (nameTrue) && (songLinkTrue))
  {
     console.log("name after submit friend", $("#name").val().trim());
      var userInfo = 
      {
            name: $("#name").val().trim(),
            songLink: $("#songLink").val().trim(),
            scores: userAnswer
      }
      console.log(userInfo);

    $.post("/api/survey", userInfo,
        function(data) {

          if (data) {
            console.log("Adding");
          }

          // Clear the form when submitting
          $("#name").val("");
          $("#songLink").val("");
          $(".stars :radio").val("");
          
        }).then(function(data) {
          console.log("WE GOT THIS FROM THE BACKEND", data.matchedUser);
          var name = data.matchedUser.name;
          var link = data.matchedUser.songLink;
          var linkId = link.split("=");
          console.log(linkId[1]);
          
          var youtubeLink = "https://www.youtube-nocookie.com/embed/" + linkId[1];
          document.getElementById("youtubeIframe").setAttribute("src", youtubeLink);
          document.getElementById("matchedName").innerHTML = name;

          console.log(document.getElementById("youtubeIframe").getAttribute("src"));
          });
    }
});


</script>

</body>
</html>